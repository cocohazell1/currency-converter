<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="í™˜ìœ¨ ê³„ì‚°ê¸°">

    <link rel="apple-touch-icon" href="https://i.ibb.co/mRpP36p/currency-icon.png">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
            crossorigin="anonymous"></script>

    <title>í™˜ìœ¨ ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&family=Cairo:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', 'Noto Sans JP', 'Cairo', sans-serif;
            background-color: #f0f2f5;
        }
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1.2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìŠ¤íƒ€ì¼ */
        .currency-item {
            transition: box-shadow 0.2s ease-in-out;
        }
        .drag-handle {
            cursor: grab;
            touch-action: none;
        }
        .dragging {
            opacity: 0.8;
            background: #e0e7ff;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
            z-index: 50;
        }
        body.is-dragging {
            user-select: none; /* ë“œë˜ê·¸ ì¤‘ í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
        }
        /* ìë™ ë†’ì´ ì¡°ì ˆ textarea */
        .autoresize-textarea {
            resize: none;
            overflow: hidden;
            min-height: 44px; /* ì´ˆê¸° ë†’ì´ */
        }
        /* ëª¨ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .mode-btn.active {
            background-color: #3b82f6;
            color: white;
        }
        .mode-btn {
            background-color: #e5e7eb;
            color: #4b5563;
        }
        /* ìƒë‹¨ ê³ ì • ìŠ¤íƒ€ì¼ (ëª¨ë“  ëª¨ë“œ) */
        #currency-list > .currency-item:first-child {
            position: sticky;
            top: 0;
            z-index: 10;
            background-color: white;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        /* ê´‘ê³  ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .ad-container {
            min-height: 100px; /* ê´‘ê³  ë¡œë”© ì „ ìµœì†Œ ë†’ì´ */
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f3f4f6;
            border-radius: 0.75rem;
            color: #9ca3af;
            font-size: 0.875rem;
            text-align: center;
            margin: 1rem 0;
            width: 100%;
        }
        /* ì˜¤í”„ë¼ì¸ ëª¨ë“œ í‘œì‹œ */
        .offline-indicator {
            background-color: #fef2f2;
            color: #b91c1c;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }
        /* ë¸”ë¡œê·¸ ë§í¬ ìŠ¤íƒ€ì¼ */
        .blog-link {
            display: inline-block;
            margin-top: 0.5rem;
            color: #3b82f6;
            text-decoration: underline;
            font-size: 0.875rem;
        }
        .blog-link:hover {
            color: #2563eb;
        }
    </style>
</head>
<body class="min-h-screen"> <div class="w-full h-full max-w-lg mx-auto bg-white rounded-none sm:rounded-2xl shadow-none sm:shadow-xl">
    <div id="main-content" class="p-6 md:p-8 pb-32"> <div class="relative text-center mb-4 pt-4">
            <h1 id="app-title" class="text-3xl font-bold text-gray-800" data-translate-key="title">í™˜ìœ¨ ê³„ì‚°ê¸°</h1>
            <div id="rate-info" class="text-sm text-gray-600 my-3">
                <p id="base-rate-display">1 USD = 0.00 KRW</p>
                <div class="flex justify-center items-center gap-2 mt-1">
                    <p id="last-updated" data-translate-key="last_updated">ìµœì¢… ì—…ë°ì´íŠ¸: -</p>
                    <div dir="ltr">
                        <select id="language-selector" class="bg-gray-100 border border-gray-300 rounded-md p-1 text-xs focus:ring-blue-500 focus:border-blue-500">
                            <option value="ko">í•œêµ­ì–´</option>
                            <option value="en">English</option>
                            <option value="ja">æ—¥æœ¬èª</option>
                            <option value="zh">ç®€ä½“ä¸­æ–‡</option>
                            <option value="es">EspaÃ±ol</option>
                            <option value="fr">FranÃ§ais</option>
                            <option value="de">Deutsch</option>
                            <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                            <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                            <option value="ka">áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜</option>
                            <option value="vi">Tiáº¿ng Viá»‡t</option>
                            <option value="th">à¹„à¸—à¸¢</option>
                            <option value="km">ááŸ’á˜áŸ‚áš</option>
                            <option value="pt">PortuguÃªs</option>
                        </select>
                    </div>
                </div>
                <a href="https://blog.naver.com/nohassle" target="_blank" class="blog-link" data-translate-key="blog_link">ë¸”ë¡œê·¸ ë°©ë¬¸í•˜ê¸°</a>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-2 p-1 bg-gray-200 rounded-lg mb-4">
            <button id="mode-expense" class="mode-btn font-bold py-2 rounded-md transition-colors" data-translate-key="mode_expense" aria-pressed="true">ê²½ë¹„ í•©ì‚°</button>
            <button id="mode-converter" class="mode-btn font-bold py-2 rounded-md transition-colors" data-translate-key="mode_converter" aria-pressed="false">í™˜ìœ¨ ë³€í™˜</button>
        </div>
        <p id="mode-tip" class="text-xs text-center text-blue-600 bg-blue-50 p-2 rounded-lg mb-4" data-translate-key="tip_expense">
            ğŸ’¡ íŒ: ì…ë ¥ì°½ì— `100+50*95%` ì²˜ëŸ¼ ê³„ì‚°í•  ìˆ˜ ìˆì–´ìš”!
        </p>

        <div id="loader" class="flex justify-center items-center h-60">
            <div class="loader"></div>
        </div>

        <div id="calculator" class="hidden">
            <div id="currency-list" class="space-y-4">
                </div>
        </div>

        <div id="error-message" class="hidden text-center p-4 bg-red-100 text-red-700 rounded-lg">
            <p data-translate-key="error_message">í™˜ìœ¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.</p>
            <button id="retry-button" class="mt-3 bg-red-700 text-white px-4 py-2 rounded-md text-sm hover:bg-red-800 transition-colors" data-translate-key="retry_button">ë‹¤ì‹œ ì‹œë„</button>
        </div>
    </div>

    <div id="total-summary-footer" class="fixed bottom-0 left-0 right-0 max-w-lg mx-auto bg-blue-600 text-white p-4 shadow-lg rounded-t-2xl hidden">
        <div class="flex justify-between items-center">
            <span class="text-lg font-bold" data-translate-key="total_sum">ì´ í•©ê³„</span>
            <span id="total-amount-display" class="text-2xl font-bold">â‚© 0</span>
        </div>
        <button id="reset-button" class="w-full mt-3 bg-white text-blue-600 font-bold py-2 rounded-lg hover:bg-gray-100 transition" data-translate-key="reset_button">ëª¨ë“  ì…ë ¥ ì´ˆê¸°í™”</button>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --------- DOM ìš”ì†Œ ì„ íƒ ---------
        const mainContent = document.getElementById('main-content');
        const currencyListContainer = document.getElementById('currency-list');
        const lastUpdated = document.getElementById('last-updated');
        const baseRateDisplay = document.getElementById('base-rate-display');
        const loader = document.getElementById('loader');
        const calculator = document.getElementById('calculator');
        const errorMessage = document.getElementById('error-message');
        const retryButton = document.getElementById('retry-button');
        const totalSummaryFooter = document.getElementById('total-summary-footer');
        const totalAmountDisplay = document.getElementById('total-amount-display');
        const resetButton = document.getElementById('reset-button');
        const modeExpenseBtn = document.getElementById('mode-expense');
        const modeConverterBtn = document.getElementById('mode-converter');
        const modeTip = document.getElementById('mode-tip');
        const languageSelector = document.getElementById('language-selector');

        // --------- ìƒíƒœ ë³€ìˆ˜ ---------
        let exchangeRates = {};
        let currentMode = 'expense';
        let currentLang = 'ko';
        let lastUpdateTimeUTC;
        let currencyOrder = [];
        let isOfflineMode = false;

        // --------- ë‹¤êµ­ì–´ ì§€ì› ---------
        const translations = {
            ko: {
                title: "í™˜ìœ¨ ê³„ì‚°ê¸°",
                last_updated: "ìµœì¢… ì—…ë°ì´íŠ¸:",
                mode_expense: "ê²½ë¹„ í•©ì‚°",
                mode_converter: "í™˜ìœ¨ ë³€í™˜",
                tip_expense: "ğŸ’¡ ì‚¬ìš©ë²•: ë§¨ ìœ„ í†µí™”ê°€ í•©ê³„ ê¸°ì¤€ì…ë‹ˆë‹¤. ì†ì¡ì´(â˜°)ë¥¼ ëŒì–´ ìˆœì„œë¥¼ ë°”ê¾¸ê³ , `10+10-10%`ì²˜ëŸ¼ ê³„ì‚°ì‹ì„ ì…ë ¥í•˜ì„¸ìš”!",
                tip_converter: "ğŸ’¡ íŒ: í•œ í†µí™”ì— ê°’ì„ ì…ë ¥í•˜ë©´ ë‚˜ë¨¸ì§€ê°€ ëª¨ë‘ ë³€í™˜ë©ë‹ˆë‹¤.",
                error_message: "í™˜ìœ¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.",
                retry_button: "ë‹¤ì‹œ ì‹œë„",
                total_sum: "ì´ í•©ê³„",
                reset_button: "ëª¨ë“  ì…ë ¥ ì´ˆê¸°í™”",
                offline_mode: "ì˜¤í”„ë¼ì¸ ëª¨ë“œ",
                blog_link: "ë¸”ë¡œê·¸ ë°©ë¬¸í•˜ê¸°",
                currency_name_krw: "ëŒ€í•œë¯¼êµ­ ì›",
                currency_name_usd: "ë¯¸êµ­ ë‹¬ëŸ¬",
                currency_name_jpy: "ì¼ë³¸ ì—”",
            },
            en: {
                title: "Currency Converter",
                last_updated: "Last Updated:",
                mode_expense: "Expense Sum",
                mode_converter: "Converter",
                tip_expense: "ğŸ’¡ How to use: The top currency is the sum's base. Drag the handle (â˜°) to reorder and enter calculations like `10+10-10%`!",
                tip_converter: "ğŸ’¡ Tip: Enter a value in one currency to convert all others.",
                error_message: "Failed to load exchange rates. Please try again later.",
                retry_button: "Try Again",
                total_sum: "Total Sum",
                reset_button: "Reset All Inputs",
                offline_mode: "Offline Mode",
                blog_link: "Visit my blog",
                currency_name_krw: "Korean Won",
                currency_name_usd: "US Dollar",
                currency_name_jpy: "Japanese Yen",
            },
            ja: {
                title: "ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆè¨ˆç®—æ©Ÿ",
                last_updated: "æœ€çµ‚æ›´æ–°:",
                mode_expense: "çµŒè²»åˆç®—",
                mode_converter: "ç‚ºæ›¿å¤‰æ›",
                tip_expense: "ğŸ’¡ä½¿ã„æ–¹: ä¸€ç•ªä¸Šã®é€šè²¨ãŒåˆè¨ˆã®åŸºæº–ã§ã™ã€‚ãƒãƒ³ãƒ‰ãƒ«(â˜°)ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦é †åºã‚’å¤‰ãˆã€`10+10-10%`ã®ã‚ˆã†ã«è¨ˆç®—å¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼",
                tip_converter: "ğŸ’¡ãƒ’ãƒ³ãƒˆï¼šä¸€ã¤ã®é€šè²¨ã«å€¤ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ä»–ãŒã™ã¹ã¦å¤‰æ›ã•ã‚Œã¾ã™ã€‚",
                error_message: "ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚å¾Œã§ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚",
                retry_button: "å†è©¦è¡Œ",
                total_sum: "åˆè¨ˆ",
                reset_button: "ã™ã¹ã¦ã®å…¥åŠ›ã‚’ãƒªã‚»ãƒƒãƒˆ",
                offline_mode: "ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰",
                blog_link: "ãƒ–ãƒ­ã‚°ã‚’è¨ªå•",
                currency_name_krw: "éŸ“å›½ã‚¦ã‚©ãƒ³",
                currency_name_usd: "ç±³ãƒ‰ãƒ«",
                currency_name_jpy: "æ—¥æœ¬å††",
            },
            zh: {
                title: "æ±‡ç‡è®¡ç®—å™¨",
                last_updated: "æœ€åæ›´æ–°:",
                mode_expense: "è´¹ç”¨åˆè®¡",
                mode_converter: "æ±‡ç‡æ¢ç®—",
                tip_expense: "ğŸ’¡ ä½¿ç”¨æ–¹æ³•: æœ€ä¸Šæ–¹çš„è´§å¸æ˜¯æ€»è®¡çš„åŸºå‡†ã€‚æ‹–åŠ¨æŠŠæ‰‹(â˜°)é‡æ–°æ’åºï¼Œå¹¶åƒ `10+10-10%` ä¸€æ ·è¾“å…¥è®¡ç®—ï¼",
                tip_converter: "ğŸ’¡ æç¤ºï¼šåœ¨ä¸€ä¸ªè´§å¸ä¸­è¾“å…¥ä¸€ä¸ªå€¼ï¼Œæ‰€æœ‰å…¶ä»–è´§å¸éƒ½ä¼šè½¬æ¢ã€‚",
                error_message: "åŠ è½½æ±‡ç‡å¤±è´¥ã€‚è¯·ç¨åå†è¯•ã€‚",
                retry_button: "é‡è¯•",
                total_sum: "æ€»è®¡",
                reset_button: "é‡ç½®æ‰€æœ‰è¾“å…¥",
                offline_mode: "ç¦»çº¿æ¨¡å¼",
                blog_link: "è®¿é—®æˆ‘çš„åšå®¢",
                currency_name_krw: "éŸ©å…ƒ",
                currency_name_usd: "ç¾å…ƒ",
                currency_name_jpy: "æ—¥å…ƒ",
            },
            // ëŸ¬ì‹œì•„ì–´ ì¶”ê°€
            ru: {
                title: "ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚ĞµÑ€ Ğ’Ğ°Ğ»ÑÑ‚",
                last_updated: "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:",
                mode_expense: "Ğ¡ÑƒĞ¼Ğ¼Ğ° Ñ€Ğ°ÑÑ…Ğ¾Ğ´Ğ¾Ğ²",
                mode_converter: "ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚ĞµÑ€",
                tip_expense: "ğŸ’¡ ĞšĞ°Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ: Ğ’ĞµÑ€Ñ…Ğ½ÑÑ Ğ²Ğ°Ğ»ÑÑ‚Ğ° ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ±Ğ°Ğ·Ğ¾Ğ¹ Ğ´Ğ»Ñ ÑÑƒĞ¼Ğ¼Ñ‹. ĞŸĞµÑ€ĞµÑ‚Ğ°Ñ‰Ğ¸Ñ‚Ğµ Ñ€ÑƒÑ‡ĞºÑƒ (â˜°) Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¸ Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ Ğ²Ñ€Ğ¾Ğ´Ğµ `10+10-10%`!",
                tip_converter: "ğŸ’¡ Ğ¡Ğ¾Ğ²ĞµÑ‚: Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ²Ğ°Ğ»ÑÑ‚Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ.",
                error_message: "ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ğ¼ĞµĞ½Ğ½Ñ‹Ğµ ĞºÑƒÑ€ÑÑ‹. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.",
                retry_button: "ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ",
                total_sum: "ĞĞ±Ñ‰Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ°",
                reset_button: "Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ²ÑĞµ",
                offline_mode: "ĞĞ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼",
                blog_link: "ĞŸĞ¾ÑĞµÑ‚Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ¹ Ğ±Ğ»Ğ¾Ğ³",
                currency_name_krw: "Ğ®Ğ¶Ğ½Ğ¾ĞºĞ¾Ñ€ĞµĞ¹ÑĞºĞ°Ñ Ğ²Ğ¾Ğ½Ğ°",
                currency_name_usd: "Ğ”Ğ¾Ğ»Ğ»Ğ°Ñ€ Ğ¡Ğ¨Ğ",
                currency_name_jpy: "Ğ¯Ğ¿Ğ¾Ğ½ÑĞºĞ°Ñ Ğ¸ĞµĞ½Ğ°",
            },
            // ì¡°ì§€ì•„ì–´
            ka: {
                title: "áƒ•áƒáƒšáƒ£áƒ¢áƒ˜áƒ¡ áƒ™áƒáƒœáƒ•áƒ”áƒ áƒ¢áƒ”áƒ áƒ˜",
                last_updated: "áƒ‘áƒáƒšáƒ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ:",
                mode_expense: "áƒ®áƒáƒ áƒ¯áƒ”áƒ‘áƒ˜áƒ¡ áƒ¯áƒáƒ›áƒ˜",
                mode_converter: "áƒ™áƒáƒœáƒ•áƒ”áƒ áƒ¢áƒ”áƒ áƒ˜",
                tip_expense: "ğŸ’¡ áƒ áƒáƒ’áƒáƒ  áƒ’áƒáƒ›áƒáƒ•áƒ˜áƒ§áƒ”áƒœáƒáƒ—: áƒ–áƒ”áƒ“áƒ áƒ•áƒáƒšáƒ£áƒ¢áƒ áƒáƒ áƒ˜áƒ¡ áƒ¯áƒáƒ›áƒ˜áƒ¡ áƒ¡áƒáƒ¤áƒ£áƒ«áƒ•áƒ”áƒšáƒ˜. áƒ’áƒáƒ“áƒáƒ˜áƒ¢áƒáƒœáƒ”áƒ— áƒ¡áƒáƒ®áƒ”áƒšáƒ£áƒ áƒ˜ (â˜°) áƒ áƒ˜áƒ’áƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒªáƒ•áƒšáƒ”áƒšáƒáƒ“ áƒ“áƒ áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ”áƒ‘áƒ˜ áƒ áƒáƒ’áƒáƒ áƒª `10+10-10%`!",
                tip_converter: "ğŸ’¡ áƒ áƒ©áƒ”áƒ•áƒ: áƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ‘áƒ áƒ”áƒ áƒ— áƒ•áƒáƒšáƒ£áƒ¢áƒáƒ¨áƒ˜, áƒ áƒáƒ› áƒ’áƒáƒ áƒ“áƒáƒ¥áƒ›áƒœáƒáƒ¡ áƒ§áƒ•áƒ”áƒšáƒ áƒ¡áƒ®áƒ•áƒ.",
                error_message: "áƒ•áƒ”áƒ  áƒ›áƒáƒ®áƒ”áƒ áƒ®áƒ“áƒ áƒ’áƒáƒªáƒ•áƒšáƒ˜áƒ—áƒ˜ áƒ™áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒ©áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ. áƒ’áƒ—áƒ®áƒáƒ•áƒ— áƒ¡áƒªáƒáƒ“áƒáƒ— áƒ›áƒáƒ’áƒ•áƒ˜áƒáƒœáƒ”áƒ‘áƒ˜áƒ—.",
                retry_button: "áƒ®áƒ”áƒšáƒáƒ®áƒšáƒ áƒªáƒ“áƒ",
                total_sum: "áƒ¡áƒ áƒ£áƒšáƒ˜ áƒ¯áƒáƒ›áƒ˜",
                reset_button: "áƒ§áƒ•áƒ”áƒšáƒ áƒ¨áƒ”áƒ§áƒ•áƒáƒœáƒ˜áƒ¡ áƒ’áƒáƒ“áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ",
                offline_mode: "áƒáƒ¤áƒšáƒáƒ˜áƒœ áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜",
                blog_link: "áƒ‘áƒšáƒáƒ’áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒ®áƒ£áƒšáƒ”áƒ‘áƒ",
            },
            // ë² íŠ¸ë‚¨ì–´
            vi: {
                title: "MÃ¡y TÃ­nh Tá»· GiÃ¡",
                last_updated: "Cáº­p nháº­t láº§n cuá»‘i:",
                mode_expense: "Tá»•ng Chi PhÃ­",
                mode_converter: "Chuyá»ƒn Äá»•i",
                tip_expense: "ğŸ’¡ CÃ¡ch sá»­ dá»¥ng: Tiá»n tá»‡ hÃ ng Ä‘áº§u lÃ  cÆ¡ sá»Ÿ cá»§a tá»•ng. KÃ©o tay cáº§m (â˜°) Ä‘á»ƒ sáº¯p xáº¿p láº¡i vÃ  nháº­p tÃ­nh toÃ¡n nhÆ° `10+10-10%`!",
                tip_converter: "ğŸ’¡ Máº¹o: Nháº­p giÃ¡ trá»‹ trong má»™t loáº¡i tiá»n Ä‘á»ƒ chuyá»ƒn Ä‘á»•i táº¥t cáº£ cÃ¡c loáº¡i tiá»n khÃ¡c.",
                error_message: "KhÃ´ng thá»ƒ táº£i tá»· giÃ¡ há»‘i Ä‘oÃ¡i. Vui lÃ²ng thá»­ láº¡i sau.",
                retry_button: "Thá»­ Láº¡i",
                total_sum: "Tá»•ng Cá»™ng",
                reset_button: "Äáº·t Láº¡i Táº¥t Cáº£",
                offline_mode: "Cháº¿ Ä‘á»™ ngoáº¡i tuyáº¿n",
                blog_link: "GhÃ© thÄƒm blog cá»§a tÃ´i",
            },
            // íƒœêµ­ì–´
            th: {
                title: "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸„à¸´à¸”à¹€à¸¥à¸‚à¸­à¸±à¸•à¸£à¸²à¹à¸¥à¸à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™",
                last_updated: "à¸­à¸±à¸›à¹€à¸”à¸•à¸¥à¹ˆà¸²à¸ªà¸¸à¸”:",
                mode_expense: "à¸£à¸§à¸¡à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢",
                mode_converter: "à¸•à¸±à¸§à¹à¸›à¸¥à¸‡",
                tip_expense: "ğŸ’¡ à¸§à¸´à¸˜à¸µà¹ƒà¸Šà¹‰: à¸ªà¸à¸¸à¸¥à¹€à¸‡à¸´à¸™à¸”à¹‰à¸²à¸™à¸šà¸™à¹€à¸›à¹‡à¸™à¸à¸²à¸™à¸‚à¸­à¸‡à¸œà¸¥à¸£à¸§à¸¡ à¸¥à¸²à¸à¸—à¸µà¹ˆà¸ˆà¸±à¸š (â˜°) à¹€à¸à¸·à¹ˆà¸­à¸ˆà¸±à¸”à¹€à¸£à¸µà¸¢à¸‡à¹ƒà¸«à¸¡à¹ˆà¹à¸¥à¸°à¸›à¹‰à¸­à¸™à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¹€à¸Šà¹ˆà¸™ `10+10-10%`!",
                tip_converter: "ğŸ’¡ à¹€à¸„à¸¥à¹‡à¸”à¸¥à¸±à¸š: à¸›à¹‰à¸­à¸™à¸„à¹ˆà¸²à¹ƒà¸™à¸ªà¸à¸¸à¸¥à¹€à¸‡à¸´à¸™à¸«à¸™à¸¶à¹ˆà¸‡à¹€à¸à¸·à¹ˆà¸­à¹à¸›à¸¥à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”",
                error_message: "à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹‚à¸«à¸¥à¸”à¸­à¸±à¸•à¸£à¸²à¹à¸¥à¸à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸”à¹‰ à¹‚à¸›à¸£à¸”à¸¥à¸­à¸‡à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡à¹ƒà¸™à¸ à¸²à¸¢à¸«à¸¥à¸±à¸‡",
                retry_button: "à¸¥à¸­à¸‡à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡",
                total_sum: "à¸¢à¸­à¸”à¸£à¸§à¸¡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”",
                reset_button: "à¸£à¸µà¹€à¸‹à¹‡à¸•à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”",
                offline_mode: "à¹‚à¸«à¸¡à¸”à¸­à¸­à¸Ÿà¹„à¸¥à¸™à¹Œ",
                blog_link: "à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡à¸šà¸¥à¹‡à¸­à¸à¸‚à¸­à¸‡à¸‰à¸±à¸™",
            },
            // ìº„ë³´ë””ì•„ì–´
            km: {
                title: "á‚áá“á¶á¢ááŸ’ášá¶á”áŸ’áá¼ášá”áŸ’ášá¶á€áŸ‹",
                last_updated: "á”á¶á“á’áŸ’áœá¾á”á…áŸ’á…á»á”áŸ’á”á“áŸ’á“á—á¶á–á…á»á„á€áŸ’ášáŸ„á™:",
                mode_expense: "á…áŸ†áá¶á™áŸášá»á”",
                mode_converter: "á€á˜áŸ’á˜áœá·á’á¸á”áŸ†á›áŸ‚á„",
                tip_expense: "ğŸ’¡ ášá”áŸ€á”á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹: ášá¼á”á·á™á”áŸááŸ’áá€áŸ†á–á¼á›á‚áºá‡á¶á˜á¼á›áŠáŸ’á‹á¶á“á“áŸƒá•á›á”á¼á€áŸ” á¢á¼áŸáŠáŸƒ (â˜°) áŠá¾á˜áŸ’á”á¸áá˜áŸ’ášáŸ€á„á¡á¾á„áœá·á‰ á“á·á„á”á‰áŸ’á…á¼á›á€á¶ášá‚áá“á¶áŠá¼á…á‡á¶ `10+10-10%`!",
                tip_converter: "ğŸ’¡ á‚á“áŸ’á›á¹áŸ‡: á”á‰áŸ’á…á¼á›áá˜áŸ’á›áŸƒá€áŸ’á“á»á„ášá¼á”á·á™á”áŸááŸ’áá˜á½á™áŠá¾á˜áŸ’á”á¸á”áŸ†á›áŸ‚á„á•áŸ’áŸáŸá„á‘áŸ€ááŸ”",
                error_message: "á”ášá¶á‡áŸá™á€áŸ’á“á»á„á€á¶ášá•áŸ’á‘á»á€á¢ááŸ’ášá¶á”áŸ’áá¼ášá”áŸ’ášá¶á€áŸ‹áŸ” áŸá¼á˜á–áŸ’á™á¶á™á¶á˜á˜áŸ’áá„á‘áŸ€áá–áŸá›á€áŸ’ášáŸ„á™áŸ”",
                retry_button: "á–áŸ’á™á¶á™á¶á˜á˜áŸ’áá„á‘áŸ€á",
                total_sum: "áŸášá»á”á‘á¶áŸ†á„á¢áŸáŸ‹",
                reset_button: "á€áŸ†áááŸ‹á¡á¾á„áœá·á‰á‘á¶áŸ†á„á¢áŸáŸ‹",
                offline_mode: "ášá”áŸ€á”á€áŸ’ášáŸ…á”ááŸ’áá¶á‰",
                blog_link: "á‘áŸáŸ’áŸá“á¶á”áŸ’á›á€áŸ‹ášá”áŸáŸ‹ááŸ’á‰á»áŸ†",
            },
            // í¬ë¥´íˆ¬ê°ˆì–´
            pt: {
                title: "Conversor de Moedas",
                last_updated: "Ãšltima AtualizaÃ§Ã£o:",
                mode_expense: "Soma de Despesas",
                mode_converter: "Conversor",
                tip_expense: "ğŸ’¡ Como usar: A moeda superior Ã© a base da soma. Arraste a alÃ§a (â˜°) para reordenar e insira cÃ¡lculos como `10+10-10%`!",
                tip_converter: "ğŸ’¡ Dica: Digite um valor em uma moeda para converter todas as outras.",
                error_message: "Falha ao carregar as taxas de cÃ¢mbio. Por favor, tente novamente mais tarde.",
                retry_button: "Tentar Novamente",
                total_sum: "Soma Total",
                reset_button: "Redefinir Todas as Entradas",
                offline_mode: "Modo Offline",
                blog_link: "Visitar meu blog",
            },
            // ë‹¤ë¥¸ ì–¸ì–´ë“¤ (ìŠ¤í˜ì¸ì–´, í”„ë‘ìŠ¤ì–´, ë…ì¼ì–´, ì•„ëì–´)
            es: { /* ìŠ¤í˜ì¸ì–´ ë²ˆì—­ */ },
            fr: { /* í”„ë‘ìŠ¤ì–´ ë²ˆì—­ */ },
            de: { /* ë…ì¼ì–´ ë²ˆì—­ */ },
            ar: { /* ì•„ëì–´ ë²ˆì—­ */ },
        };

        // --------- í†µí™” ë°ì´í„° ---------
        const targetCurrencies = {
            'KRW': { country: 'kr', name: 'ëŒ€í•œë¯¼êµ­ ì›', symbol: 'â‚©' },
            'JPY': { country: 'jp', name: 'ì¼ë³¸ ì—”', symbol: 'Â¥' },
            'CNY': { country: 'cn', name: 'ì¤‘êµ­ ìœ„ì•ˆ', symbol: 'Â¥' },
            'HKD': { country: 'hk', name: 'í™ì½© ë‹¬ëŸ¬', symbol: '$' },
            'SGD': { country: 'sg', name: 'ì‹±ê°€í¬ë¥´ ë‹¬ëŸ¬', symbol: '$' },
            'THB': { country: 'th', name: 'íƒœêµ­ ë°”íŠ¸', symbol: 'à¸¿' },
            'VND': { country: 'vn', name: 'ë² íŠ¸ë‚¨ ë™', symbol: 'â‚«' },
            'IDR': { country: 'id', name: 'ì¸ë„ë„¤ì‹œì•„ ë£¨í”¼ì•„', symbol: 'Rp' },
            'PHP': { country: 'ph', name: 'í•„ë¦¬í•€ í˜ì†Œ', symbol: 'â‚±' },
            'MYR': { country: 'my', name: 'ë§ë ˆì´ì‹œì•„ ë§ê¹ƒ', symbol: 'RM' },
            'INR': { country: 'in', name: 'ì¸ë„ ë£¨í”¼', symbol: 'â‚¹' },
            'KHR': { country: 'kh', name: 'ìº„ë³´ë””ì•„ ë¦¬ì—˜', symbol: 'áŸ›' },
            'LAK': { country: 'la', name: 'ë¼ì˜¤ìŠ¤ í‚µ', symbol: 'â‚­' },
            'USD': { country: 'us', name: 'ë¯¸êµ­ ë‹¬ëŸ¬', symbol: '$' },
            'CAD': { country: 'ca', name: 'ìºë‚˜ë‹¤ ë‹¬ëŸ¬', symbol: '$' },
            'MXN': { country: 'mx', name: 'ë©•ì‹œì½” í˜ì†Œ', symbol: '$' },
            'BRL': { country: 'br', name: 'ë¸Œë¼ì§ˆ í—¤ì•Œ', symbol: 'R$' },
            'ARS': { country: 'ar', name: 'ì•„ë¥´í—¨í‹°ë‚˜ í˜ì†Œ', symbol: '$' },
            'CLP': { country: 'cl', name: 'ì¹ ë ˆ í˜ì†Œ', symbol: '$' },
            'COP': { country: 'co', name: 'ì½œë¡¬ë¹„ì•„ í˜ì†Œ', symbol: '$' },
            'PEN': { country: 'pe', name: 'í˜ë£¨ ì†”', symbol: 'S/.' },
            'EUR': { country: 'eu', name: 'ìœ ëŸ½ ìœ ë¡œ', symbol: 'â‚¬' },
            'GBP': { country: 'gb', name: 'ì˜êµ­ íŒŒìš´ë“œ', symbol: 'Â£' },
            'CHF': { country: 'ch', name: 'ìŠ¤ìœ„ìŠ¤ í”„ë‘', symbol: 'Fr' },
            'TRY': { country: 'tr', name: 'í„°í‚¤ ë¦¬ë¼', symbol: 'â‚º' },
            'PLN': { country: 'pl', name: 'í´ë€ë“œ ì¦ˆì›Œí‹°', symbol: 'zÅ‚' },
            'CZK': { country: 'cz', name: 'ì²´ì½” ì½”ë£¨ë‚˜', symbol: 'KÄ' },
            'HUF': { country: 'hu', name: 'í—ê°€ë¦¬ í¬ë¦°íŠ¸', symbol: 'Ft' },
            'BAM': { country: 'ba', name: 'ë³´ìŠ¤ë‹ˆì•„ ë§ˆë¥´ì¹´', symbol: 'KM' },
            'RSD': { country: 'rs', name: 'ì„¸ë¥´ë¹„ì•„ ë””ë‚˜ë¥´', symbol: 'din' },
            'MKD': { country: 'mk', name: 'ë¶ë§ˆì¼€ë„ë‹ˆì•„ ë°ë‚˜ë¥´', symbol: 'Ğ´ĞµĞ½' },
            'ALL': { country: 'al', name: 'ì•Œë°”ë‹ˆì•„ ë ‰', symbol: 'L' },
            'BGN': { country: 'bg', name: 'ë¶ˆê°€ë¦¬ì•„ ë ˆí”„', symbol: 'Ğ»Ğ²' },
            'RON': { country: 'ro', name: 'ë£¨ë§ˆë‹ˆì•„ ë ˆìš°', symbol: 'lei' },
            'MDL': { country: 'md', name: 'ëª°ë„ë°” ë ˆìš°', symbol: 'L' },
            'GEL': { country: 'ge', name: 'ì¡°ì§€ì•„ ë¼ë¦¬', symbol: 'â‚¾' },
            'NOK': { country: 'no', name: 'ë…¸ë¥´ì›¨ì´ í¬ë¡œë„¤', symbol: 'kr' },
            'SEK': { country: 'se', name: 'ìŠ¤ì›¨ë´ í¬ë¡œë‚˜', symbol: 'kr' },
            'DKK': { country: 'dk', name: 'ë´ë§ˆí¬ í¬ë¡œë„¤', symbol: 'kr' },
            'AUD': { country: 'au', name: 'í˜¸ì£¼ ë‹¬ëŸ¬', symbol: '$' },
            'NZD': { country: 'nz', name: 'ë‰´ì§ˆëœë“œ ë‹¬ëŸ¬', symbol: '$' },
            'AED': { country: 'ae', name: 'UAE ë””ë¥´í•¨', symbol: 'Ø¯.Ø¥' },
            'ILS': { country: 'il', name: 'ì´ìŠ¤ë¼ì—˜ ì…°ì¼ˆ', symbol: 'â‚ª' },
            'EGP': { country: 'eg', name: 'ì´ì§‘íŠ¸ íŒŒìš´ë“œ', symbol: 'EÂ£' },
            'ZAR': { country: 'za', name: 'ë‚¨ì•„ê³µ ëœë“œ', symbol: 'R' },
        };

        // --------- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---------

        // ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ ê°ì§€
        window.addEventListener('online', () => {
            fetchRates(); // ì˜¨ë¼ì¸ ìƒíƒœê°€ ë˜ë©´ ìµœì‹  í™˜ìœ¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        });

        // ì–¸ì–´ ë³€ê²½ ì²˜ë¦¬
        languageSelector.addEventListener('change', (e) => setLanguage(e.target.value));

        // ì´ˆê¸°í™”
        function initializeApp() {
            // ì €ì¥ëœ í†µí™” ìˆœì„œ ë¶ˆëŸ¬ì˜¤ê¸°
            loadCurrencyOrder();

            // í™˜ìœ¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            fetchRates();

            // ì¬ì‹œë„ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            retryButton.addEventListener('click', () => fetchRates());
        }

        // --------- ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ìœ í‹¸ë¦¬í‹° ---------

        // ì•ˆì „í•˜ê²Œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function getSafeLocalStorage(key, defaultValue) {
            try {
                const value = localStorage.getItem(key);
                return value !== null ? value : defaultValue;
            } catch (e) {
                console.warn("localStorage ì ‘ê·¼ ì˜¤ë¥˜:", e);
                return defaultValue;
            }
        }

        // ì•ˆì „í•˜ê²Œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥í•˜ê¸°
        function setSafeLocalStorage(key, value) {
            try {
                localStorage.setItem(key, value);
                return true;
            } catch (e) {
                console.warn("localStorage ì €ì¥ ì˜¤ë¥˜:", e);
                return false;
            }
        }

        // í†µí™” ìˆœì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadCurrencyOrder() {
            try {
                const savedOrder = getSafeLocalStorage('currencyOrder', null);
                if (savedOrder) {
                    const parsedOrder = JSON.parse(savedOrder);
                    // ì €ì¥ëœ í†µí™”ê°€ ëª¨ë‘ ìœ íš¨í•œì§€ í™•ì¸
                    if (Array.isArray(parsedOrder) && parsedOrder.length > 0 &&
                        parsedOrder.every(code => targetCurrencies[code])) {
                        currencyOrder = parsedOrder;
                        return;
                    }
                }
                // ì €ì¥ëœ ìˆœì„œê°€ ì—†ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš°, ê¸°ë³¸ ìˆœì„œ ì‚¬ìš©
                currencyOrder = Object.keys(targetCurrencies);
            } catch (e) {
                console.warn("ì €ì¥ëœ í†µí™” ìˆœì„œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:", e);
                currencyOrder = Object.keys(targetCurrencies);
            }
        }

        // --------- API í˜¸ì¶œ ---------

        // í™˜ìœ¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì¬ì‹œë„ ë¡œì§ í¬í•¨)
        async function fetchRates(retryCount = 3, delay = 1000) {
            showLoader();

            for (let i = 0; i < retryCount; i++) {
                try {
                    const response = await fetch('https://open.er-api.com/v6/latest/USD');

                    if (!response.ok) {
                        throw new Error(`Network response was not ok: ${response.status}`);
                    }

                    const data = await response.json();

                    if (data.result === 'success') {
                        // í™˜ìœ¨ ë°ì´í„° ì €ì¥ ë° UI ì´ˆê¸°í™”
                        exchangeRates = data.rates;
                        lastUpdateTimeUTC = data.time_last_update_utc;
                        isOfflineMode = false;

                        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ìºì‹±
                        cacheExchangeRates(data);

                        // ì‚¬ìš©ì ì–¸ì–´ ì„¤ì • ë¡œë“œ
                        const savedLang = getSafeLocalStorage('preferredLanguage', 'ko');
                        languageSelector.value = savedLang;

                        // ê¸°ë³¸ ëª¨ë“œ ì„¤ì •
                        setMode(currentMode);
                        applyTranslations(savedLang);
                        addModeSwitchListeners();
                        showCalculator();
                        return;
                    } else {
                        throw new Error('API ì˜¤ë¥˜: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                    }
                } catch (error) {
                    console.error(`í™˜ìœ¨ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ (ì‹œë„ ${i+1}/${retryCount}):`, error);

                    if (i === retryCount - 1) {
                        // ëª¨ë“  ì¬ì‹œë„ ì‹¤íŒ¨ ì‹œ ìºì‹œëœ ë°ì´í„° ì‚¬ìš© ì‹œë„
                        if (tryLoadCachedRates()) {
                            return;
                        }

                        showError();
                    } else {
                        // ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¬ì‹œë„ ê°„ê²© ì¦ê°€
                        await new Promise(resolve => setTimeout(resolve, delay * Math.pow(2, i)));
                    }
                }
            }
        }

        // í™˜ìœ¨ ì •ë³´ ìºì‹±
        function cacheExchangeRates(data) {
            try {
                setSafeLocalStorage('cachedRates', JSON.stringify(data));
                setSafeLocalStorage('ratesTimestamp', Date.now().toString());
            } catch (e) {
                console.warn("ìºì‹œ ì €ì¥ ì‹¤íŒ¨:", e);
            }
        }

        // ìºì‹œëœ í™˜ìœ¨ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
        function tryLoadCachedRates() {
            try {
                const cachedData = getSafeLocalStorage('cachedRates', null);
                if (cachedData) {
                    const parsedData = JSON.parse(cachedData);
                    exchangeRates = parsedData.rates;
                    lastUpdateTimeUTC = parsedData.time_last_update_utc;
                    isOfflineMode = true;

                    setMode(currentMode);
                    applyTranslations(currentLang);
                    addModeSwitchListeners();
                    showCalculator();
                    return true;
                }
            } catch (e) {
                console.error("ìºì‹œ ë°ì´í„° ì‚¬ìš© ì‹¤íŒ¨:", e);
            }
            return false;
        }

        // --------- ë‹¤êµ­ì–´ ì§€ì› ---------

        // ë²ˆì—­ ì ìš©
        function applyTranslations(lang) {
            // ë°ì´í„° ì†ì„±ì„ ê¸°ì¤€ìœ¼ë¡œ ë²ˆì—­
            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                if(translations[lang] && translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });

            // í†µí™” ì¹´ë“œ ë²ˆì—­
            document.querySelectorAll('.currency-item').forEach(card => {
                const input = card.querySelector('.currency-input');
                if (!input) return;

                const code = input.dataset.currencyCode.toLowerCase();
                const nameEl = card.querySelector(`[data-translate-key="currency_name_${code}"]`);
                const pronEl = card.querySelector(`[data-translate-key="currency_pronunciation_${code}"]`);

                if(nameEl && translations[lang] && translations[lang][`currency_name_${code}`]) {
                    nameEl.textContent = translations[lang][`currency_name_${code}`];
                }
                if(pronEl && translations[lang] && translations[lang][`currency_pronunciation_${code}`]) {
                    pronEl.textContent = translations[lang][`currency_pronunciation_${code}`];
                }
            });

            // ìµœì¢… ì—…ë°ì´íŠ¸ ì‹œê°„ ë²ˆì—­
            if(lastUpdateTimeUTC) {
                const updateDate = new Date(lastUpdateTimeUTC);
                const lastUpdatedPrefix = translations[lang].last_updated || "Last Updated:";
                let updatedText = `${lastUpdatedPrefix} ${updateDate.toLocaleString(lang)}`;

                // ì˜¤í”„ë¼ì¸ ëª¨ë“œ í‘œì‹œ
                if (isOfflineMode) {
                    updatedText += ` <span class="offline-indicator">${translations[lang].offline_mode || "Offline Mode"}</span>`;
                }

                lastUpdated.innerHTML = updatedText;
            }

            // UI ëª¨ë“œì— ë”°ë¥¸ ë²ˆì—­ ì—…ë°ì´íŠ¸
            updateModeUI();
        }

        // ì–¸ì–´ ì„¤ì •
        function setLanguage(lang) {
            currentLang = lang;
            setSafeLocalStorage('preferredLanguage', lang);
            languageSelector.value = lang;
            document.documentElement.lang = lang;
            document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';
            applyTranslations(lang);
        }

        // --------- ëª¨ë“œ ê´€ë¦¬ ---------

        // ëª¨ë“œ ì„¤ì • (ê²½ë¹„ í•©ì‚°/í™˜ìœ¨ ë³€í™˜)
        function setMode(newMode) {
            currentMode = newMode;
            buildCalculatorUI(); // DOM ì¬êµ¬ì„±
            addDragDropListeners(); // ìƒˆ DOMì— ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            applyTranslations(currentLang); // ìƒˆ DOM ë²ˆì—­
            updateModeUI();
        }

        // ëª¨ë“œ UI ì—…ë°ì´íŠ¸
        function updateModeUI() {
            currencyListContainer.className = 'space-y-4';

            if(currentMode === 'expense') {
                modeExpenseBtn.classList.add('active');
                modeExpenseBtn.setAttribute('aria-pressed', 'true');
                modeConverterBtn.classList.remove('active');
                modeConverterBtn.setAttribute('aria-pressed', 'false');
                totalSummaryFooter.classList.remove('hidden');
                mainContent.style.paddingBottom = '8rem';
                modeTip.dataset.translateKey = 'tip_expense';
            } else {
                modeConverterBtn.classList.add('active');
                modeConverterBtn.setAttribute('aria-pressed', 'true');
                modeExpenseBtn.classList.remove('active');
                modeExpenseBtn.setAttribute('aria-pressed', 'false');
                totalSummaryFooter.classList.add('hidden');
                mainContent.style.paddingBottom = '2rem';
                modeTip.dataset.translateKey = 'tip_converter';
            }

            modeTip.textContent = translations[currentLang][modeTip.dataset.translateKey] || modeTip.dataset.translateKey;
        }

        // ëª¨ë“œ ì „í™˜ ë²„íŠ¼ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        function addModeSwitchListeners() {
            modeExpenseBtn.addEventListener('click', () => setMode('expense'));
            modeConverterBtn.addEventListener('click', () => setMode('converter'));
        }

        // --------- UI êµ¬ì„± ë° ì¡°ì‘ ---------

        // ê´‘ê³  ì»¨í…Œì´ë„ˆ ìƒì„±
        function createAdPlaceholder() {
            const adContainer = document.createElement('div');
            adContainer.className = 'ad-container';
            adContainer.innerHTML = `<ins class="adsbygoogle" style="display:block" data-ad-format="auto" data-full-width-responsive="true" data-ad-client="ca-pub-XXXXXXXXXXXXXXXX" data-ad-slot="XXXXXXXXXX"></ins>`;
            return adContainer;
        }

        // í†µí™” ì¹´ë“œ ìƒì„±
        function createCurrencyCard(code) {
            const currency = targetCurrencies[code];
            const card = document.createElement('div');

            const inputElement = currentMode === 'expense'
                ? `<textarea class="autoresize-textarea currency-input w-full bg-white text-right font-semibold text-lg text-gray-800 rounded-md py-2 pl-8 pr-4 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" data-currency-code="${code}" placeholder="0" rows="1" aria-label="${code} ê¸ˆì•¡ ì…ë ¥"></textarea>`
                : `<input type="text" inputmode="decimal" class="currency-input w-full bg-white text-right font-semibold text-lg text-gray-800 rounded-md py-2 pl-8 pr-4 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" data-currency-code="${code}" placeholder="0.00" aria-label="${code} ê¸ˆì•¡ ì…ë ¥">`;

            card.className = `flex items-center gap-3 p-3 bg-gray-50 rounded-xl border-2 border-transparent transition-shadow duration-300 currency-item`;
            card.innerHTML = `<div class="drag-handle p-2" aria-label="í†µí™” ìˆœì„œ ë³€ê²½" role="button" tabindex="0"><svg class="w-6 h-6 text-gray-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></div>
                    <div class="flex flex-col items-center w-14 text-center">
                        <img src="https://flagcdn.com/w40/${currency.country}.png" alt="${code}" class="w-10 h-10 rounded-full shadow-sm" onerror="this.style.display='none'">
                        <p class="text-xs text-gray-500 mt-1 w-full truncate" data-translate-key="currency_name_${code.toLowerCase()}">${currency.name}</p>
                    </div>
                    <div class="flex-grow">
                        <p class="font-bold text-gray-800">${code}</p>
                        <p class="text-xs text-gray-500" data-translate-key="currency_pronunciation_${code.toLowerCase()}"></p>
                    </div>
                    <div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg">${currency.symbol}</span>${inputElement}</div>`;
            return card;
        }

        // ê³„ì‚°ê¸° UI êµ¬ì„±
        function buildCalculatorUI() {
            currencyListContainer.innerHTML = '';
            const finalOrder = currencyOrder;

            finalOrder.forEach((code, index) => {
                currencyListContainer.appendChild(createCurrencyCard(code));
                // ê´‘ê³  ì‚½ì… (5ë²ˆì§¸ì™€ 15ë²ˆì§¸ ìœ„ì¹˜)
                if (currentMode === 'expense' && (index === 5 || index === 15)) {
                    currencyListContainer.appendChild(createAdPlaceholder());
                }
            });

            // ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            addInputListeners();

            // ë¦¬ì…‹ ë²„íŠ¼ ê¸°ëŠ¥
            if (currentMode === 'expense') {
                resetButton.onclick = resetAllInputs;
            }

            // ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
            initializeAdsense();

            updateBaseRateDisplay();
        }

        // ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        function addInputListeners() {
            document.querySelectorAll('.currency-input').forEach(input => {
                if(currentMode === 'expense') {
                    input.addEventListener('input', (e) => {
                        updateTotalAmount();
                        autoResizeTextarea(e.target);
                    });
                } else {
                    input.addEventListener('input', handleConverterInput);
                }
            });
        }

        // ëª¨ë“  ì…ë ¥ ì´ˆê¸°í™”
        function resetAllInputs() {
            document.querySelectorAll('.currency-input').forEach(input => {
                input.value = '';
                autoResizeTextarea(input);
            });
            updateTotalAmount();
        }

        // AdSense ì´ˆê¸°í™”
        function initializeAdsense() {
            setTimeout(() => {
                document.querySelectorAll('.adsbygoogle').forEach(ad => {
                    if (ad.innerHTML.trim().length > 0) return;
                    try {
                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        if(ad.parentElement) ad.parentElement.style.display = 'none';
                        console.error("AdSense push error:", e);
                    }
                });
            }, 150);
        }

        // textarea ë†’ì´ ìë™ ì¡°ì ˆ
        function autoResizeTextarea(textarea) {
            if (textarea && textarea.tagName && textarea.tagName.toLowerCase() === 'textarea') {
                textarea.style.height = 'auto';
                textarea.style.height = textarea.scrollHeight + 'px';
            }
        }

        // --------- ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê´€ë¦¬ ---------

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        function addDragDropListeners() {
            const container = document.getElementById('currency-list');
            if (!container) return;

            let draggingEl = null;
            let initialY = 0;
            let initialScroll = 0;

            // í¬ì¸í„° ë‹¤ìš´(í„°ì¹˜/ë§ˆìš°ìŠ¤) ì´ë²¤íŠ¸ ì²˜ë¦¬
            const onPointerDown = (e) => {
                const handle = e.target.closest('.drag-handle');
                if (!handle) return;

                draggingEl = handle.closest('.currency-item');
                if (!draggingEl) return;

                // ê¸°ë³¸ ë™ì‘ ë°©ì§€
                if (e.type === 'touchstart') e.preventDefault();

                // ì´ˆê¸° ìœ„ì¹˜ ê¸°ë¡
                initialY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
                initialScroll = window.scrollY;

                // ë“œë˜ê·¸ ìŠ¤íƒ€ì¼ ì ìš©
                draggingEl.classList.add('dragging');
                document.body.classList.add('is-dragging');

                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
                if (e.type === 'mousedown') {
                    document.addEventListener('mousemove', onPointerMove);
                    document.addEventListener('mouseup', onPointerUp);
                } else { // touchstart
                    document.addEventListener('touchmove', onPointerMove, { passive: false });
                    document.addEventListener('touchend', onPointerUp);
                }

                // í¬ì»¤ìŠ¤ëœ ìš”ì†Œê°€ ìˆìœ¼ë©´ ë¸”ëŸ¬ ì²˜ë¦¬
                if (document.activeElement && document.activeElement.blur) {
                    document.activeElement.blur();
                }
            };

            // í¬ì¸í„° ì›€ì§ì„ ì²˜ë¦¬
            const onPointerMove = (e) => {
                if (!draggingEl) return;
                e.preventDefault();

                const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
                const afterElement = getDragAfterElement(container, clientY);

                if (afterElement) {
                    container.insertBefore(draggingEl, afterElement);
                } else {
                    container.appendChild(draggingEl);
                }

                // í™”ë©´ ìë™ ìŠ¤í¬ë¡¤
                handleAutoscroll(clientY);
            };

            // ìë™ ìŠ¤í¬ë¡¤ ì²˜ë¦¬
            const handleAutoscroll = (clientY) => {
                const scrollThreshold = 150;
                const viewportHeight = window.innerHeight;

                if (clientY < scrollThreshold) {
                    // ìœ„ë¡œ ìŠ¤í¬ë¡¤
                    window.scrollBy(0, -10);
                } else if (clientY > viewportHeight - scrollThreshold) {
                    // ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤
                    window.scrollBy(0, 10);
                }
            };

            // í¬ì¸í„° ì—… ì´ë²¤íŠ¸ ì²˜ë¦¬
            const onPointerUp = () => {
                if (!draggingEl) return;

                // ìŠ¤íƒ€ì¼ ë° í´ë˜ìŠ¤ ì œê±°
                draggingEl.classList.remove('dragging');
                document.body.classList.remove('is-dragging');

                // í˜„ì¬ ìˆœì„œ ì €ì¥
                saveCurrencyOrder();

                // ê´€ë ¨ UI ì—…ë°ì´íŠ¸
                updateBaseRateDisplay();
                updateTotalAmount();

                draggingEl = null;

                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
                document.removeEventListener('mousemove', onPointerMove);
                document.removeEventListener('mouseup', onPointerUp);
                document.removeEventListener('touchmove', onPointerMove);
                document.removeEventListener('touchend', onPointerUp);
            };

            // í˜„ì¬ í†µí™” ìˆœì„œ ì €ì¥
            const saveCurrencyOrder = () => {
                currencyOrder = Array.from(container.querySelectorAll('.currency-item'))
                    .map(item => item.querySelector('.currency-input').dataset.currencyCode);

                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— í†µí™” ìˆœì„œ ì €ì¥
                setSafeLocalStorage('currencyOrder', JSON.stringify(currencyOrder));
            };

            // ë“œë˜ê·¸ í•¸ë“¤ì— í‚¤ë³´ë“œ ì ‘ê·¼ì„± ì¶”ê°€
            container.querySelectorAll('.drag-handle').forEach(handle => {
                // í„°ì¹˜ ì´ë²¤íŠ¸ ì²˜ë¦¬
                handle.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                }, { passive: false });

                // í‚¤ë³´ë“œ ì ‘ê·¼ì„± (Enter ë˜ëŠ” Spaceë¡œ ì´ë™)
                handle.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();

                        const item = handle.closest('.currency-item');
                        const sibling = e.shiftKey ? item.previousElementSibling : item.nextElementSibling;

                        if (sibling && sibling.classList.contains('currency-item')) {
                            if (e.shiftKey) {
                                container.insertBefore(item, sibling);
                            } else {
                                container.insertBefore(sibling, item);
                            }

                            // ìˆœì„œ ì—…ë°ì´íŠ¸
                            saveCurrencyOrder();
                            updateBaseRateDisplay();
                            updateTotalAmount();

                            // í•¸ë“¤ì— ë‹¤ì‹œ í¬ì»¤ìŠ¤
                            setTimeout(() => {
                                handle.focus();
                            }, 10);
                        }
                    }
                });
            });

            // ì»¨í…Œì´ë„ˆì— ë“œë˜ê·¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            container.addEventListener('mousedown', onPointerDown);
            container.addEventListener('touchstart', onPointerDown, { passive: false });
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìš”ì†Œ ìœ„ì¹˜ ê³„ì‚°
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.currency-item:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;

                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // --------- ê³„ì‚° ê´€ë ¨ ê¸°ëŠ¥ ---------

        // ì•ˆì „í•œ ìˆ˜ì‹ ê³„ì‚° í•¨ìˆ˜
        function evaluateExpression(str) {
            if (!str || str.trim() === '') return 0;

            // ìœ„í—˜í•œ ë¬¸ì ì œê±°
            let evalStr = str.replace(/[\n\r]/g, ' ')
                .replace(/[^0-9\.\+\-\*\/\(\)\%\s]/g, '')
                .trim();

            // ëì— ì—°ì‚°ìê°€ ìˆìœ¼ë©´ ì œê±°
            if (/[+\-*/]$/.test(evalStr)) evalStr = evalStr.slice(0, -1).trim();

            if (evalStr === '') return 0;

            // ë°±ë¶„ìœ¨ ê³„ì‚° ì²˜ë¦¬
            evalStr = evalStr.replace(/(\d*\.?\d+)\s*([+\-])\s*(\d*\.?\d+)\s*%/g,
                (m, p1, p2, p3) => `${p1} ${p2} (${p1} * ${p3} / 100)`);

            evalStr = evalStr.replace(/(\d*\.?\d+)\s*%/g, '( $1 / 100 )');

            try {
                // ì•ˆì „í•œ ìˆ˜í•™ í‘œí˜„ì‹ ê³„ì‚°
                return calculateMathExpression(evalStr);
            } catch (e) {
                console.error("ê³„ì‚° ì˜¤ë¥˜:", e);
                return 0;
            }
        }

        // ì•ˆì „í•œ ìˆ˜í•™ í‘œí˜„ì‹ ê³„ì‚°ê¸°
        function calculateMathExpression(expression) {
            // ê´„í˜¸ ì²˜ë¦¬
            while (expression.includes('(') && expression.includes(')')) {
                expression = expression.replace(/\(([^()]+)\)/g, (match, expr) => {
                    return calculateMathExpression(expr);
                });
            }

            // ì—°ì‚°ì ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ê³„ì‚°
            // 1. ê³±ì…ˆê³¼ ë‚˜ëˆ—ì…ˆ
            let result = expression;
            while (/(\d+\.?\d*)\s*([*/])\s*(\d+\.?\d*)/.test(result)) {
                result = result.replace(/(\d+\.?\d*)\s*([*/])\s*(\d+\.?\d*)/, (match, a, op, b) => {
                    a = parseFloat(a);
                    b = parseFloat(b);
                    return op === '*' ? a * b : a / b;
                });
            }

            // 2. ë§ì…ˆê³¼ ëº„ì…ˆ
            while (/(\d+\.?\d*)\s*([+\-])\s*(\d+\.?\d*)/.test(result)) {
                result = result.replace(/(\d+\.?\d*)\s*([+\-])\s*(\d+\.?\d*)/, (match, a, op, b) => {
                    a = parseFloat(a);
                    b = parseFloat(b);
                    return op === '+' ? a + b : a - b;
                });
            }

            return parseFloat(result) || 0;
        }

        // ê¸°ì¤€ í™˜ìœ¨ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateBaseRateDisplay() {
            const firstCardInput = document.querySelector('#currency-list .currency-input');
            if (!firstCardInput) return;

            const baseCode = firstCardInput.dataset.currencyCode;
            let quoteCode = 'USD';

            if (baseCode === 'USD') quoteCode = 'EUR';

            if (!exchangeRates[quoteCode] || !exchangeRates[baseCode]) return;

            const rate = exchangeRates[quoteCode] / exchangeRates[baseCode];
            baseRateDisplay.textContent = `1 ${baseCode} = ${rate.toFixed(4)} ${quoteCode}`;
        }

        // ì´ì•¡ ì—…ë°ì´íŠ¸
        function updateTotalAmount() {
            if (currentMode !== 'expense') return;

            const firstCardInput = document.querySelector('#currency-list .currency-input');
            if (!firstCardInput) return;

            const baseCurrencyCode = firstCardInput.dataset.currencyCode;
            let totalUSD = 0;

            // ëª¨ë“  í†µí™”ì˜ ì…ë ¥ê°’ì„ USDë¡œ ë³€í™˜í•˜ì—¬ í•©ì‚°
            document.querySelectorAll('.currency-input').forEach(input => {
                const code = input.dataset.currencyCode;
                const value = evaluateExpression(input.value);

                if (!isNaN(value) && value > 0) {
                    if (exchangeRates[code]) {
                        totalUSD += value / exchangeRates[code];
                    }
                }
            });

            // USD í•©ê³„ë¥¼ ê¸°ì¤€ í†µí™”ë¡œ ë³€í™˜
            if (!exchangeRates[baseCurrencyCode]) return;

            const totalInBaseCurrency = totalUSD * exchangeRates[baseCurrencyCode];
            const baseSymbol = targetCurrencies[baseCurrencyCode].symbol;

            // í•©ê³„ í‘œì‹œ (ì²œ ë‹¨ìœ„ êµ¬ë¶„)
            totalAmountDisplay.textContent = `${baseSymbol} ${Math.round(totalInBaseCurrency).toLocaleString('ko-KR')}`;
        }

        // í™˜ìœ¨ ë³€í™˜ ëª¨ë“œ ì…ë ¥ ì²˜ë¦¬
        function handleConverterInput(event) {
            const sourceInput = event.target;
            const sourceCode = sourceInput.dataset.currencyCode;
            const sourceValue = parseFloat(sourceInput.value.replace(/,/g, ''));

            // ë¹„ì–´ìˆê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ì…ë ¥ì¼ ê²½ìš° ë‹¤ë¥¸ ì…ë ¥ì¹¸ ë¹„ìš°ê¸°
            if(isNaN(sourceValue)) {
                document.querySelectorAll('.currency-input').forEach(input => {
                    if(input !== sourceInput) input.value = '';
                });
                return;
            }

            // ì…ë ¥ëœ ê°’ì„ USDë¡œ ë³€í™˜
            const sourceValueInUSD = sourceValue / exchangeRates[sourceCode];

            // USD ê¸°ì¤€ìœ¼ë¡œ ë‹¤ë¥¸ ëª¨ë“  í†µí™” ë³€í™˜
            document.querySelectorAll('.currency-input').forEach(input => {
                if(input !== sourceInput) {
                    const targetCode = input.dataset.currencyCode;
                    if(!exchangeRates[targetCode]) return;

                    const targetValue = sourceValueInUSD * exchangeRates[targetCode];

                    // ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€ í‘œì‹œ, ì²œ ë‹¨ìœ„ êµ¬ë¶„
                    input.value = targetValue.toLocaleString('en-US', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                }
            });
        }

        // UI ìƒíƒœ í•¨ìˆ˜ë“¤
        function showLoader() {
            loader.classList.remove('hidden');
            calculator.classList.add('hidden');
            errorMessage.classList.add('hidden');
        }

        function showCalculator() {
            loader.classList.add('hidden');
            errorMessage.classList.add('hidden');
            calculator.classList.remove('hidden');
        }

        function showError() {
            loader.classList.add('hidden');
            calculator.classList.add('hidden');
            errorMessage.classList.remove('hidden');
        }

        // ì•± ì´ˆê¸° ì‹¤í–‰
        initializeApp();
    });
</script>
</body>
</html>
